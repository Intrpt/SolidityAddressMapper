{"contracts":{"MyToken.sol":{"MyToken":{"evm":{"deployedBytecode":{"object":"60806040523480156100115760006000fd5b506004361061003b5760003560e01c806390b98a1114610041578063f8b2cb4f146100a65761003b565b60006000fd5b61008e600480360360408110156100585760006000fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190803590602001909291905050506100ff565b60405180821515815260200191505060405180910390f35b6100e9600480360360208110156100bd5760006000fd5b81019080803573ffffffffffffffffffffffffffffffffffffffff169060200190929190505050610273565b6040518082815260200191505060405180910390f35b600081600060005060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600050541015610157576000905061026d565b81600060005060003373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020600082828250540392505081909090555081600060005060008573ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282825054019250508190909055508273ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff167fddf252ad1be2c89b69c2b068fc378daa952ba7f163c4a11628f55a4df523b3ef846040518082815260200191505060405180910390a36001905061026d565b92915050565b6000600060005060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000505490506102c2565b91905056fea2646970667358221220e5d2254625c06894833bf164dc9b6c08f7131b9c1ecbf0e0883529ed48955f9964736f6c63430007060033","sourceMap":"266:648:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;519:285;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;811:100;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;519:285;577:15;632:6;609:8;;;:20;618:10;609:20;;;;;;;;;;;;;;;;;;:29;605:47;;;647:5;640:12;;;;605:47;687:6;663:8;;;:20;672:10;663:20;;;;;;;;;;;;;;;;:30;;;;;;;;;;;;;;;720:6;704:8;;;:12;713:2;704:12;;;;;;;;;;;;;;;;:22;;;;;;;;;;;;;;;763:2;742:32;;751:10;742:32;;;767:6;742:32;;;;;;;;;;;;;;;;;;792:4;785:11;;;;519:285;;;;;:::o;811:100::-;865:4;889:8;;;:14;898:4;889:14;;;;;;;;;;;;;;;;;;882:21;;;;811:100;;;;:::o"}},"metadata":"{\"compiler\":{\"version\":\"0.7.6+commit.7338295f\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"constructor\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_from\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"_to\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"_value\",\"type\":\"uint256\"}],\"name\":\"Transfer\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"addr\",\"type\":\"address\"}],\"name\":\"getBalance\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"},{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"sendCoin\",\"outputs\":[{\"internalType\":\"bool\",\"name\":\"sufficient\",\"type\":\"bool\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"MyToken.sol\":\"MyToken\"},\"evmVersion\":\"istanbul\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\",\"useLiteralContent\":true},\"optimizer\":{\"details\":{\"constantOptimizer\":false,\"cse\":false,\"deduplicate\":false,\"jumpdestRemover\":false,\"orderLiterals\":false,\"peephole\":false,\"yul\":false},\"runs\":200},\"remappings\":[]},\"sources\":{\"MyToken.sol\":{\"content\":\"/*\\n * @source: https://ericrafaloff.com/analyzing-the-erc20-short-address-attack/\\n * Upgraded from Solidity 0.4 to 0.7, vulnerability may no longer exist\\n * @author: -\\n * @vulnerable_at_lines: 20\\n */\\n\\n// SPDX-License-Identifier: UNLICENSED\\npragma solidity ^0.7.0;\\n\\n contract MyToken {\\n     mapping (address => uint) balances;\\n\\n     event Transfer(address indexed _from, address indexed _to, uint256 _value);\\n\\n     constructor() {\\n         balances[tx.origin] = 10000;\\n     }\\n     // <yes> <report> SHORT_ADDRESSES\\n     function sendCoin(address to, uint amount) public returns(bool sufficient) {\\n         if (balances[msg.sender] < amount) return false;\\n         balances[msg.sender] -= amount;\\n         balances[to] += amount;\\n         emit Transfer(msg.sender, to, amount);\\n         return true;\\n     }\\n\\n     function getBalance(address addr) public view returns(uint) {\\n         return balances[addr];\\n     }\\n }\\n\",\"keccak256\":\"0x7c6f8b2b31f51392b84ca7ff486d312d20ca853ca2e32a6234ebc7309b33f0bd\",\"license\":\"UNLICENSED\"}},\"version\":1}"}}},"sources":{"MyToken.sol":{"id":0}}}

