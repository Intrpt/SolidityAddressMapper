{"contracts":{"SimpleDAO.sol":{"SimpleDAO":{"evm":{"deployedBytecode":{"object":"60806040526004361061003e5760003560e01c8062362a95146100435780632e1a7d4d1461005f57806359f1286d14610088578063d5d44d80146100c5575b600080fd5b61005d60048036038101906100589190610328565b610102565b005b34801561006b57600080fd5b506100866004803603810190610081919061038b565b61015a565b005b34801561009457600080fd5b506100af60048036038101906100aa9190610328565b610265565b6040516100bc91906103c7565b60405180910390f35b3480156100d157600080fd5b506100ec60048036038101906100e79190610328565b6102ad565b6040516100f991906103c7565b60405180910390f35b346000808373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002060008282546101509190610411565b9250508190555050565b806000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff16815260200190815260200160002054106102625760003373ffffffffffffffffffffffffffffffffffffffff16826040516101c590610476565b60006040518083038185875af1925050503d8060008114610202576040519150601f19603f3d011682016040523d82523d6000602084013e610207565b606091505b50509050816000803373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff1681526020019081526020016000206000828254610259919061048b565b92505081905550505b50565b60008060008373ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff168152602001908152602001600020549050919050565b60006020528060005260406000206000915090505481565b600080fd5b600073ffffffffffffffffffffffffffffffffffffffff82169050919050565b60006102f5826102ca565b9050919050565b610305816102ea565b811461031057600080fd5b50565b600081359050610322816102fc565b92915050565b60006020828403121561033e5761033d6102c5565b5b600061034c84828501610313565b91505092915050565b6000819050919050565b61036881610355565b811461037357600080fd5b50565b6000813590506103858161035f565b92915050565b6000602082840312156103a1576103a06102c5565b5b60006103af84828501610376565b91505092915050565b6103c181610355565b82525050565b60006020820190506103dc60008301846103b8565b92915050565b7f4e487b7100000000000000000000000000000000000000000000000000000000600052601160045260246000fd5b600061041c82610355565b915061042783610355565b925082820190508082111561043f5761043e6103e2565b5b92915050565b600081905092915050565b50565b6000610460600083610445565b915061046b82610450565b600082019050919050565b600061048182610453565b9150819050919050565b600061049682610355565b91506104a183610355565b92508282039050818111156104b9576104b86103e2565b5b9291505056fea264697066735822122070e199b6406b00886a0d486b2137c693de6f5c4d316fd6906d2bfae5e4611f9564736f6c63430008180033","sourceMap":"273:454:0:-:0;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;340:77;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;421:213;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;638:87;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;296:39;;;;;;;;;;;;;;;;;;;;;;;:::i;:::-;;:::i;:::-;;;;;;;:::i;:::-;;;;;;;;340:77;403:9;389:6;:10;396:2;389:10;;;;;;;;;;;;;;;;:23;;;;;;;:::i;:::-;;;;;;;;340:77;:::o;421:213::-;490:6;469;:18;476:10;469:18;;;;;;;;;;;;;;;;:27;465:165;;542:8;555:10;:15;;578:6;555:34;;;;;:::i;:::-;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;541:48;;;617:6;597;:18;604:10;597:18;;;;;;;;;;;;;;;;:26;;;;;;;:::i;:::-;;;;;;;;498:132;465:165;421:213;:::o;638:87::-;692:4;710:6;:10;717:2;710:10;;;;;;;;;;;;;;;;703:17;;638:87;;;:::o;296:39::-;;;;;;;;;;;;;;;;;:::o;88:117:1:-;197:1;194;187:12;334:126;371:7;411:42;404:5;400:54;389:65;;334:126;;;:::o;466:96::-;503:7;532:24;550:5;532:24;:::i;:::-;521:35;;466:96;;;:::o;568:122::-;641:24;659:5;641:24;:::i;:::-;634:5;631:35;621:63;;680:1;677;670:12;621:63;568:122;:::o;696:139::-;742:5;780:6;767:20;758:29;;796:33;823:5;796:33;:::i;:::-;696:139;;;;:::o;841:329::-;900:6;949:2;937:9;928:7;924:23;920:32;917:119;;;955:79;;:::i;:::-;917:119;1075:1;1100:53;1145:7;1136:6;1125:9;1121:22;1100:53;:::i;:::-;1090:63;;1046:117;841:329;;;;:::o;1176:77::-;1213:7;1242:5;1231:16;;1176:77;;;:::o;1259:122::-;1332:24;1350:5;1332:24;:::i;:::-;1325:5;1322:35;1312:63;;1371:1;1368;1361:12;1312:63;1259:122;:::o;1387:139::-;1433:5;1471:6;1458:20;1449:29;;1487:33;1514:5;1487:33;:::i;:::-;1387:139;;;;:::o;1532:329::-;1591:6;1640:2;1628:9;1619:7;1615:23;1611:32;1608:119;;;1646:79;;:::i;:::-;1608:119;1766:1;1791:53;1836:7;1827:6;1816:9;1812:22;1791:53;:::i;:::-;1781:63;;1737:117;1532:329;;;;:::o;1867:118::-;1954:24;1972:5;1954:24;:::i;:::-;1949:3;1942:37;1867:118;;:::o;1991:222::-;2084:4;2122:2;2111:9;2107:18;2099:26;;2135:71;2203:1;2192:9;2188:17;2179:6;2135:71;:::i;:::-;1991:222;;;;:::o;2219:180::-;2267:77;2264:1;2257:88;2364:4;2361:1;2354:15;2388:4;2385:1;2378:15;2405:191;2445:3;2464:20;2482:1;2464:20;:::i;:::-;2459:25;;2498:20;2516:1;2498:20;:::i;:::-;2493:25;;2541:1;2538;2534:9;2527:16;;2562:3;2559:1;2556:10;2553:36;;;2569:18;;:::i;:::-;2553:36;2405:191;;;;:::o;2602:147::-;2703:11;2740:3;2725:18;;2602:147;;;;:::o;2755:114::-;;:::o;2875:398::-;3034:3;3055:83;3136:1;3131:3;3055:83;:::i;:::-;3048:90;;3147:93;3236:3;3147:93;:::i;:::-;3265:1;3260:3;3256:11;3249:18;;2875:398;;;:::o;3279:379::-;3463:3;3485:147;3628:3;3485:147;:::i;:::-;3478:154;;3649:3;3642:10;;3279:379;;;:::o;3664:194::-;3704:4;3724:20;3742:1;3724:20;:::i;:::-;3719:25;;3758:20;3776:1;3758:20;:::i;:::-;3753:25;;3802:1;3799;3795:9;3787:17;;3826:1;3820:4;3817:11;3814:37;;;3831:18;;:::i;:::-;3814:37;3664:194;;;;:::o"}},"metadata":"{\"compiler\":{\"version\":\"0.8.24+commit.e11b9ed9\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"inputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"name\":\"credit\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"}],\"name\":\"donate\",\"outputs\":[],\"stateMutability\":\"payable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"to\",\"type\":\"address\"}],\"name\":\"queryCredit\",\"outputs\":[{\"internalType\":\"uint256\",\"name\":\"\",\"type\":\"uint256\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"uint256\",\"name\":\"amount\",\"type\":\"uint256\"}],\"name\":\"withdraw\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{},\"version\":1},\"userdoc\":{\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"SimpleDAO.sol\":\"SimpleDAO\"},\"evmVersion\":\"istanbul\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\",\"useLiteralContent\":true},\"optimizer\":{\"enabled\":false,\"runs\":200},\"remappings\":[]},\"sources\":{\"SimpleDAO.sol\":{\"content\":\"/*\\n * @source: http://blockchain.unica.it/projects/ethereum-survey/attacks.html#simpledao\\n * Upgraded from Solidity 0.4 to 0.8, vulnerability may no longer exist\\n * @author: -\\n * @vulnerable_at_lines: 21\\n */\\n\\n// SPDX-License-Identifier: UNLICENSED\\npragma solidity ^0.8.0;\\n\\ncontract SimpleDAO {\\n  mapping (address => uint) public credit;\\n\\n  function donate(address to) public payable {\\n    credit[to] += msg.value;\\n  }\\n\\n  function withdraw(uint amount) public {\\n    if (credit[msg.sender]>= amount) {\\n      // <yes> <report> REENTRANCY\\n      (bool res,) = msg.sender.call{value: amount}(\\\"\\\");\\n      credit[msg.sender]-=amount;\\n    }\\n  }\\n\\n  function queryCredit(address to) public view returns (uint){\\n    return credit[to];\\n  }\\n}\\n\",\"keccak256\":\"0x2581bc8bdab51465ac1290de98fdb9f225e1d566e636a34a180b74e243b99427\",\"license\":\"UNLICENSED\"}},\"version\":1}"}}},"errors":[{"component":"general","errorCode":"2072","formattedMessage":"Warning: Unused local variable.\n  --> SimpleDAO.sol:21:8:\n   |\n21 |       (bool res,) = msg.sender.call{value: amount}(\"\");\n   |        ^^^^^^^^\n\n","message":"Unused local variable.","severity":"warning","sourceLocation":{"end":550,"file":"SimpleDAO.sol","start":542},"type":"Warning"}],"sources":{"SimpleDAO.sol":{"id":0}}}

